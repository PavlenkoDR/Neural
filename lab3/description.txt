Запишите точность работы сети после обучения на тестовых данных. Она приводится в последней строке вывода:

Точность работы на тестовых данных: 84.13%

Проанализируйте точность на проверочной выборке в процессе обучения. Она указывается после заголовка val_acc. Началось ли переобучение нейронной сети?

Экспериментируем с гиперпараметрами обучения
Мы попытаемся улучшить качество обучения сети путем изменения гиперпараметров: количество эпох обучения, количество нейронов на слое LSTM, алгоритм оптимизации. Для этого проведем серию экспериментов, в каждом из которых будем менять один из гиперпараметров, и анализировать, как изменилось качество работы сети.

Количество эпох обучения. Оценим влияние количества эпох обучения на качество обучения сети. Количество эпох задается в аргументе epochs метода model.fit:

 model.fit(X_train, y_train, batch_size=64, epochs=7,
   validation_data=(X_test, y_test), verbose=2)

Попробуйте обучать сеть в течение 5, 10 и 15 эпох. Определите, когда начинается переобучение. Выберите количество эпох, при котором самая высокая точность работы сети на тестовых данных.

Количество нейронов в слое LSTM. Оцените влияние количества нейронов в LSTM слое сети на качество обучения. Количество нейронов задается при добавлении слоя в модель:

 model.add(LSTM(XXX, dropout=0.2, recurrent_dropout=0.2))
Используйте количество нейронов 50, 125, 150. Выберите количество нейронов в LSTM слое, при котором обеспечивается самая высокая точность обучения. Проанализируйте влияния количества нейронов в LSTM слое на время обучения сети.

Алгоритм оптимизации. Выясним, как влияет алгоритм оптимизации на качество обучения. В базовой версии программы используется эффективный алгоритм оптимизации Adam. Попробуйте заменить его на стандартный алгоритм стохастического градиентного спуска (Stochastic gradient descent, SGD). Для этого поменяйте значение параметра optimizer при компиляции модели:

 model.compile(loss='binary_crossentropy',
       optimizer='SGD',
       metrics=['accuracy'])
       
Выбираем лучшие гиперпараметры
Создайте сеть с лучшими значениями всех гиперпараметров обучения, которые вы определили на предыдущем шаге. Увеличилась ли точность работы сети?

Как сочетание гиперпараметров влияет на время обучения сети? На переобучение?

Что можно сделать, чтобы еще больше увеличить точность?